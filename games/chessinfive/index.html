<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChessInFive - Place. Move. Align Five. Win.</title>

    <!-- Meta Tags SEO -->
    <meta name="description" content="ChessInFive: Un juego h√≠brido que combina Connect Four con Ajedrez. Coloca piezas con gravedad, mu√©velas estrat√©gicamente y alinea 5 para ganar.">
    <meta name="keywords" content="ajedrez, chess, connect four, estrategia, juego de mesa, ChessInFive">

    <!-- Favicon -->
    <link rel="icon" href="../../assets/images/favicon.ico">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">

    <!-- NeonChess Design System -->
    <link rel="stylesheet" href="../../assets/css/neonchess-style.css">

    <!-- ChessInFive Styles -->
    <link rel="stylesheet" href="css/chessinfive.css">

    <!-- AI Toggle Styles -->
    <style>
        /* AI Toggle per Player (NEW - inside player panels) */
        .player-ai-toggle {
            padding: 8px 12px;
            margin: 10px 0;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            display: flex;
            justify-content: center;
        }

        .ai-player-toggle-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            user-select: none;
        }

        .ai-player-checkbox {
            display: none;
        }

        .ai-player-slider {
            position: relative;
            width: 44px;
            height: 22px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 11px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s;
        }

        .ai-player-slider::before {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #fff;
            top: 1px;
            left: 2px;
            transition: all 0.3s;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
        }

        .ai-player-checkbox:checked + .ai-player-slider {
            background: rgba(0, 188, 212, 0.4);
            border-color: #00bcd4;
        }

        .ai-player-checkbox:checked + .ai-player-slider::before {
            left: 22px;
            background: #00ffff;
            box-shadow: 0 0 12px #00ffff;
        }

        .ai-player-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.8);
            font-weight: bold;
            min-width: 80px;
        }

        /* Cyan player specific color when AI enabled */
        #ai-toggle-cyan:checked ~ .ai-player-text {
            color: var(--cyan-primary);
        }

        /* Magenta player specific color when AI enabled */
        #ai-toggle-magenta:checked ~ .ai-player-text {
            color: var(--magenta-primary);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 0.7; transform: translate(-50%, -50%) scale(1.05); }
        }
    </style>

    <!-- Howler.js for Sound -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-N3EKXHPD5Y"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-N3EKXHPD5Y');
    </script>
</head>
<body class="neon-theme">

    <!-- Header -->
    <header class="game-header">
        <button id="btnHome" class="btn-home" title="Volver al inicio">
            <span class="icon-home">üè†</span>
            <span class="btn-text">HOME</span>
        </button>
        <div class="header-title-container">
            <h1 class="game-title">
                <span class="icon">‚öîÔ∏è</span>
                ChessInFive
            </h1>
            <p class="game-subtitle">Place. Move. Align Five. Win.</p>
        </div>
        <div class="header-controls">
            <!-- Sound Toggle -->
            <button id="soundToggle" class="btn-icon" title="Toggle Sound">
                <span class="icon-sound-on">üîä</span>
                <span class="icon-sound-off" style="display: none;">üîá</span>
            </button>
            <!-- Leaderboard Button -->
            <button id="btnLeaderboard" class="btn-icon" title="View Leaderboard">
                <span class="icon-leaderboard">üèÜ</span>
            </button>
        </div>
    </header>

    <!-- Main Game Container -->
    <main class="game-container">

        <!-- Top Panel: Solo Phase Indicator (FLECHA AZUL - ARRIBA) -->
        <div class="top-panel">
            <!-- Phase Indicator -->
            <div class="phase-indicator">
                <h2 id="phaseTitle">PHASE 1: GRAVITY PLACEMENT</h2>
                <p id="phaseDescription">Click on a column to drop your piece</p>
            </div>
        </div>

        <!-- Middle Row: Players + Board -->
        <div class="middle-row">
            <!-- Left: Cyan Player (FLECHA AMARILLA - IZQUIERDA) -->
            <aside class="player-panel player-panel-left">
                <!-- Player Info Box (header + pieces left + inventory) -->
                <div class="player-info" id="playerCyan">
                    <div class="player-header">
                        <span class="player-icon">‚öîÔ∏è</span>
                        <h3>CYAN PLAYER</h3>
                    </div>

                    <!-- AI Toggle for Cyan Player -->
                    <div class="player-ai-toggle">
                        <label class="ai-player-toggle-label">
                            <input type="checkbox" id="ai-toggle-cyan" class="ai-player-checkbox" />
                            <span class="ai-player-slider"></span>
                            <span class="ai-player-text" id="ai-status-cyan">üë§ Human</span>
                        </label>
                        <span id="aiThinkingCyan" class="ai-thinking-hourglass" style="display: none;">‚è≥</span>
                    </div>

                    <div class="player-stats">
                        <div class="stat">
                            <span class="label">Pieces Left:</span>
                            <span id="cyanPiecesLeft" class="value">8</span>
                        </div>
                        <div class="pieces-inventory" id="cyanInventory">
                            <!-- Pieces will be shown here -->
                        </div>
                    </div>
                </div>

                <!-- Mobile Turn Indicator (Fase 2 mobile only) -->
                <div class="mobile-turn-indicator">
                    <h3 class="player-name-display">CYAN PLAYER</h3>
                    <p>YOUR TURN - Select a piece to move</p>
                </div>

                <!-- Piece Selector for Cyan (SEPARADO - Gravity Phase only) -->
                <div class="piece-selector" id="pieceSelector">
                    <h3>SELECT PIECE</h3>
                    <div class="piece-options">
                        <button class="piece-option" data-piece="rook">
                            <span class="piece-symbol" id="selectedRook"></span>
                            <span class="piece-name">ROOK</span>
                            <span class="piece-count" id="countRook">2</span>
                        </button>
                        <button class="piece-option" data-piece="knight">
                            <span class="piece-symbol" id="selectedKnight"></span>
                            <span class="piece-name">KNIGHT</span>
                            <span class="piece-count" id="countKnight">2</span>
                        </button>
                        <button class="piece-option" data-piece="bishop">
                            <span class="piece-symbol" id="selectedBishop"></span>
                            <span class="piece-name">BISHOP</span>
                            <span class="piece-count" id="countBishop">2</span>
                        </button>
                        <button class="piece-option" data-piece="queen">
                            <span class="piece-symbol" id="selectedQueen"></span>
                            <span class="piece-name">QUEEN</span>
                            <span class="piece-count" id="countQueen">1</span>
                        </button>
                        <button class="piece-option" data-piece="king">
                            <span class="piece-symbol" id="selectedKing"></span>
                            <span class="piece-name">KING</span>
                            <span class="piece-count" id="countKing">1</span>
                        </button>
                    </div>
                </div>
            </aside>

            <!-- Center: Chess Board -->
            <div class="board-container">
                <div id="chessBoard" class="chess-board">
                    <!-- Board will be generated by JavaScript -->
                </div>

                <!-- Desktop Turn Indicator (debajo del tablero) -->
                <div class="turn-indicator desktop-turn">
                    <p>Current Turn:</p>
                    <h3 id="currentTurnText">CYAN PLAYER</h3>
                </div>
            </div>

            <!-- Right: Magenta Player (FLECHA AMARILLA - DERECHA) -->
            <aside class="player-panel player-panel-right">
                <!-- Player Info Box (header + pieces left + inventory) -->
                <div class="player-info" id="playerMagenta">
                    <div class="player-header">
                        <span class="player-icon">‚öîÔ∏è</span>
                        <h3>MAGENTA PLAYER</h3>
                    </div>

                    <!-- AI Toggle for Magenta Player -->
                    <div class="player-ai-toggle">
                        <label class="ai-player-toggle-label">
                            <input type="checkbox" id="ai-toggle-magenta" class="ai-player-checkbox" />
                            <span class="ai-player-slider"></span>
                            <span class="ai-player-text" id="ai-status-magenta">üë§ Human</span>
                        </label>
                        <span id="aiThinkingMagenta" class="ai-thinking-hourglass" style="display: none;">‚è≥</span>
                    </div>

                    <div class="player-stats">
                        <div class="stat">
                            <span class="label">Pieces Left:</span>
                            <span id="magentaPiecesLeft" class="value">8</span>
                        </div>
                        <div class="pieces-inventory" id="magentaInventory">
                            <!-- Pieces will be shown here -->
                        </div>
                    </div>
                </div>

                <!-- Mobile Turn Indicator (Fase 2 mobile only) -->
                <div class="mobile-turn-indicator">
                    <h3 class="player-name-display">MAGENTA PLAYER</h3>
                    <p>YOUR TURN - Select a piece to move</p>
                </div>

                <!-- Piece Selector for Magenta (SEPARADO - Gravity Phase only) -->
                <div class="piece-selector piece-selector-magenta" id="pieceSelectorMagenta">
                    <h3>SELECT PIECE</h3>
                    <div class="piece-options">
                        <button class="piece-option" data-piece="rook">
                            <span class="piece-symbol" id="selectedRookMagenta"></span>
                            <span class="piece-name">ROOK</span>
                            <span class="piece-count" id="countRookMagenta">2</span>
                        </button>
                        <button class="piece-option" data-piece="knight">
                            <span class="piece-symbol" id="selectedKnightMagenta"></span>
                            <span class="piece-name">KNIGHT</span>
                            <span class="piece-count" id="countKnightMagenta">2</span>
                        </button>
                        <button class="piece-option" data-piece="bishop">
                            <span class="piece-symbol" id="selectedBishopMagenta"></span>
                            <span class="piece-name">BISHOP</span>
                            <span class="piece-count" id="countBishopMagenta">2</span>
                        </button>
                        <button class="piece-option" data-piece="queen">
                            <span class="piece-symbol" id="selectedQueenMagenta"></span>
                            <span class="piece-name">QUEEN</span>
                            <span class="piece-count" id="countQueenMagenta">1</span>
                        </button>
                        <button class="piece-option" data-piece="king">
                            <span class="piece-symbol" id="selectedKingMagenta"></span>
                            <span class="piece-name">KING</span>
                            <span class="piece-count" id="countKingMagenta">1</span>
                        </button>
                    </div>
                </div>
            </aside>
        </div>

        <!-- Bottom Panel: Controls Only (FLECHA ROJA - ABAJO) -->
        <div class="bottom-panel">
            <!-- Game Controls -->
            <div class="game-controls">
                <button id="btnNewGame" class="btn-primary">NEW GAME</button>
                <button id="btnUndo" class="btn-secondary" disabled>UNDO MOVE</button>
                <button id="btnHelp" class="btn-secondary">HELP</button>
            </div>
        </div>

    </main>

    <!-- Game Over Modal -->
    <div id="gameOverModal" class="modal" style="display: none;">
        <div class="modal-content">
            <button class="modal-close" id="btnCloseGameOver">‚úï</button>
            <h2 id="winnerTitle">CYAN PLAYER WINS!</h2>
            <p id="winnerMessage">Five pieces aligned!</p>

            <!-- Player Name Input for Leaderboard -->
            <div style="margin: 20px 0;">
                <label for="gameOverPlayerNameInput" style="display: block; margin-bottom: 8px; color: var(--cyan-primary, #00ffff); font-weight: bold; font-family: 'Orbitron', sans-serif;">Enter Your Name:</label>
                <input type="text" id="gameOverPlayerNameInput" maxlength="20" placeholder="Your Name"
                       style="width: 100%; padding: 10px; background: rgba(0, 255, 255, 0.1); border: 2px solid var(--cyan-primary, #00ffff); border-radius: 8px; color: white; font-family: 'Orbitron', monospace; font-size: 16px; text-align: center;">
            </div>

            <div class="modal-actions">
                <button id="gameOverSubmitScoreBtn" class="btn-primary">üèÜ SUBMIT SCORE</button>
                <button id="gameOverViewLeaderboardBtn" class="btn-secondary">üëÅÔ∏è VIEW LEADERBOARD</button>
                <button id="btnPlayAgain" class="btn-primary">PLAY AGAIN</button>
                <button id="btnBackHome" class="btn-secondary">BACK TO HOME</button>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal" style="display: none;">
        <div class="modal-content modal-large">
            <button class="modal-close" id="btnCloseHelp">‚úï</button>
            <h2>HOW TO PLAY CHESSINFIVE</h2>

            <div class="help-section">
                <h3>‚öîÔ∏è Concept</h3>
                <p>ChessInFive is a hybrid strategy game combining <strong>Connect Four</strong> gravity mechanics with <strong>Chess</strong> tactical movement.</p>
            </div>

            <div class="help-section">
                <h3>ü™Ç Phase 1: Gravity Placement</h3>
                <ul>
                    <li>Each player has <strong>8 pieces</strong>: 2 Rooks, 2 Knights, 2 Bishops, 1 Queen, 1 King</li>
                    <li>Click on a column to drop your piece (gravity applies)</li>
                    <li>Pieces fall until they hit the bottom or another piece</li>
                    <li>Players alternate turns until all 16 pieces are placed</li>
                </ul>
            </div>

            <div class="help-section">
                <h3>‚ôüÔ∏è Phase 2: Chess Movement</h3>
                <ul>
                    <li>Move your pieces according to <strong>chess rules</strong></li>
                    <li><strong>NO CAPTURES</strong> - occupied squares are blocked</li>
                    <li><strong>NO CHECK</strong> - the king is just another piece</li>
                    <li>Only the <strong>Knight can jump</strong> over other pieces</li>
                </ul>
            </div>

            <div class="help-section">
                <h3>üèÜ Victory</h3>
                <p>First player to align <strong>5 or more pieces</strong> in a row (horizontal, vertical, or diagonal) wins!</p>
            </div>

            <div class="help-section">
                <h3>‚ôüÔ∏è Piece Movements</h3>
                <ul>
                    <li><strong>‚ôñ Rook:</strong> Horizontal or vertical, blocked by pieces</li>
                    <li><strong>‚ôò Knight:</strong> L-shape (2+1), CAN JUMP over pieces</li>
                    <li><strong>‚ôó Bishop:</strong> Diagonal, blocked by pieces</li>
                    <li><strong>‚ôï Queen:</strong> Any direction, blocked by pieces</li>
                    <li><strong>‚ôî King:</strong> 1 square any direction, blocked by pieces</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- How to Play Instructions -->
    <section class="how-to-play-section">
        <div class="instructions">
            <h2>‚öîÔ∏è How to Play ChessInFive</h2>
            <p><strong>ChessInFive</strong> is a unique hybrid strategy game combining Connect Four gravity with Chess tactical movement!</p>

            <p>üéØ <strong>Objective:</strong> Be the first to align 5 or more of your pieces in a row (horizontal, vertical, or diagonal).</p>

            <p>ü™Ç <strong>Phase 1 - Gravity Placement:</strong> Each player has 8 pieces (2 Rooks, 2 Knights, 2 Bishops, 1 Queen, 1 King). Select your piece type and click on a column to drop it. Pieces fall with gravity until they land on the bottom or another piece. Players alternate turns until all 16 pieces are placed.</p>

            <p>‚ôüÔ∏è <strong>Phase 2 - Chess Movement:</strong> Move your pieces according to authentic chess rules! Click a piece to see valid moves (highlighted squares). <strong>NO CAPTURES</strong> - occupied squares block movement. Only Knights can jump over other pieces. <strong>NO CHECK</strong> - the King is treated like any other piece.</p>

            <p>üèÜ <strong>Victory Condition:</strong> First player to create a line of 5 or more pieces wins immediately!</p>

            <p>üí° <strong>Strategy Tips:</strong> During Phase 1, plan ahead! Place pieces where they can move effectively in Phase 2. Control the center. Create threats that force your opponent to defend. Knights are valuable for jumping over blocked positions!</p>

            <p>üéÆ <strong>Controls:</strong> Click "HELP" button during the game for detailed piece movement rules and game mechanics.</p>
        </div>
    </section>

    <!-- Footer -->
    <footer style="background: rgba(26, 0, 51, 0.9); padding: 2rem 1rem; margin-top: 4rem; border-top: 2px solid var(--neon-cyan); text-align: center;">
        <div style="max-width: 1200px; margin: 0 auto;">
            <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 2rem; margin-bottom: 1.5rem;">
                <a href="../../articles.html" style="color: var(--neon-cyan); text-decoration: none; font-weight: bold; transition: all 0.3s ease;">Art√≠culos</a>
                <a href="../../chess_rules.html" style="color: var(--neon-cyan); text-decoration: none; font-weight: bold; transition: all 0.3s ease;">Reglas del Ajedrez</a>
                <a href="../../about.html" style="color: var(--neon-cyan); text-decoration: none; font-weight: bold; transition: all 0.3s ease;">Acerca de</a>
                <a href="../../contact.html" style="color: var(--neon-cyan); text-decoration: none; font-weight: bold; transition: all 0.3s ease;">Contacto</a>
                <a href="../../privacy-policy.html" style="color: var(--neon-cyan); text-decoration: none; font-weight: bold; transition: all 0.3s ease;">Pol√≠tica de Privacidad</a>
            </div>
            <p style="color: var(--text-secondary); font-size: 0.9rem; margin: 0;">
                ¬© 2025 ChessArcade. Todos los derechos reservados.
            </p>
            <p style="color: var(--neon-magenta); font-size: 0.85rem; margin-top: 0.5rem;">
                Hecho con üíú para la comunidad de ajedrez
            </p>
        </div>
    </footer>

    <!-- Leaderboard Integration -->
    <link rel="stylesheet" href="../../css/leaderboard.css">
    <script src="../../js/leaderboard-api.js"></script>
    <script src="../../js/leaderboard-ui.js"></script>

    <!-- ChessInFive JavaScript Modules -->
    <script src="js/game-state.js"></script>
    <script src="js/piece-manager.js"></script>
    <script src="js/board-renderer.js"></script>
    <script src="js/gravity-phase.js"></script>
    <script src="js/chess-phase.js"></script>
    <script src="js/win-detection.js"></script>
    <script src="js/sound-manager.js"></script>
    <script src="js/ui-controller.js"></script>
    <script src="js/ai-player.js"></script>
    <script src="js/ai-controller.js"></script>
    <script src="js/main.js"></script>
    <script src="js/leaderboard-integration.js"></script>
</body>
</html>
